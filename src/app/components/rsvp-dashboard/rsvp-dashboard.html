@if (confirmDeleteId()) {
  <app-confirm-dialog
    title="Excluir convite"
    message="Tem certeza que deseja excluir este convite? Esta aÃ§Ã£o nÃ£o pode ser desfeita."
    confirmLabel="Excluir"
    cancelLabel="Cancelar"
    [danger]="true"
    (confirmed)="confirmDelete()"
    (cancelled)="confirmDeleteId.set(null)" />
}

<div class="dashboard-container animate-fade-in">
  <!-- Perfil -->
  <section class="profile-section">
    <div class="profile-card card-base">
      <div class="profile-header">
        <div class="profile-info">
          <h2>OlÃ¡, {{ getUserName() }}</h2>
          <p>{{ authService.currentUser()?.email }}</p>
        </div>
      </div>
      <div class="profile-stats">
        <div class="stat-item">
          <span class="stat-value">{{ cards().length }}</span>
          <span class="stat-label">Convites</span>
        </div>
        <div class="stat-item">
          <span class="stat-value">{{ getTotalResponses() }}</span>
          <span class="stat-label">Respostas</span>
        </div>
        <div class="stat-item">
          <span class="stat-value">{{ getTotalAcceptanceRate() }}%</span>
          <span class="stat-label">AceitaÃ§Ã£o</span>
        </div>
      </div>
      <button class="btn btn-danger" (click)="logout()">Sair</button>
    </div>
  </section>

  <!-- Convites -->
  <header class="dashboard-header">
    <div>
      <h1>Meus convites</h1>
    </div>
    <button class="btn btn-primary" (click)="createNew()">Novo convite</button>
  </header>

  @if (cards().length === 0) {
    <div class="empty-state card-base">
      <span class="empty-icon">ðŸ“«</span>
      <h2>Nenhum convite criado</h2>
      <p>Crie seu primeiro convite interativo</p>
      <button class="btn btn-primary" (click)="createNew()">Criar convite</button>
    </div>
  } @else {
    <div class="cards-grid">
      @for (card of cards(); track card.id) {
        @let stats = getStats(card.id!);
        <div class="dashboard-card card-base">
          <div class="card-header">
            <h3>{{ card.title }}</h3>
            <span class="card-date">
              {{ card.createdAt ? 'Criado em ' + (card.createdAt | date:'dd/MM/yyyy') : '' }}
            </span>
          </div>

          <div class="card-info">
            <p><strong>Enviado por:</strong> {{ card.senderName }}</p>
          </div>

          <div class="stats-bar">
            <div class="stat">
              <span class="stat-number stat-yes">{{ stats.yes }}</span>
              <span class="stat-label">ComparecerÃ£o</span>
            </div>
          </div>

          <div class="card-actions">
            <button class="btn btn-ghost" (click)="viewCard(card.id!)">Ver</button>
            <button class="btn btn-ghost btn-whatsapp-sm" (click)="shareWhatsApp(card)">WhatsApp</button>
            <button class="btn btn-ghost" (click)="copyLink(card.id!)">
              {{ linkCopied() === card.id ? 'âœ“ Copiado' : 'Link' }}
            </button>
            <button class="btn btn-ghost btn-danger" (click)="deleteCard(card.id!)">Excluir</button>
          </div>
        </div>
      }
    </div>
  }
</div>
